<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Input &mdash; MPAS-Analysis 1.9.0rc3 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Output" href="output.html" />
    <link rel="prev" title="Diagnostics" href="diagnostics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MPAS-Analysis
          </a>
              <div class="version">
                1.9.0rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User's guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../configuration.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="runs.html">Runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="execute.html">Execute</a></li>
<li class="toctree-l2"><a class="reference internal" href="dask_threads.html">Dask threads and subprocess count</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html">Diagnostics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input-directories">Input Directories</a></li>
<li class="toctree-l3"><a class="reference internal" href="#namelist-files">Namelist Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streams-files">Streams Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mesh-name">Mesh Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xarray-and-dask">Xarray and Dask</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errors-on-missing-data">Errors on Missing Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="climatology.html">Climatology</a></li>
<li class="toctree-l2"><a class="reference internal" href="timeSeries.html">Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html">Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="regions.html">Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot.html">Plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="html.html">HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="observations.html">Ocean, Sea Ice and Iceberg Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessed.html">Preprocessed Reference Runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="colormaps.html">Colormaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="seasons.html">Seasons</a></li>
<li class="toctree-l2"><a class="reference internal" href="comparison_grids.html">Comparison Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="moving_average.html">Moving Average</a></li>
<li class="toctree-l2"><a class="reference internal" href="time_axis_ticks.html">Time-Axis Tick Marks</a></li>
<li class="toctree-l2"><a class="reference internal" href="transects.html">Output Grids for Transects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_tasks.html">Analysis Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components.html">MPAS Components and E3SM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observations.html">Observations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developers_guide/api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design_docs/index.html">Design Documents</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/getting_started.html">User: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_getting_started.html">Developer: Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_understand_a_task.html">Developers: Understanding an analysis task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/dev_add_task.html">Developers: Adding a new analysis task</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Authors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Main Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html#contributors">Contributors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MPAS-Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../configuration.html">Configuration</a></li>
      <li class="breadcrumb-item active">Input</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/users_guide/config/input.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="input">
<span id="config-input"></span><h1>Input<a class="headerlink" href="#input" title="Permalink to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">[input]</span></code> section of a configuration file contains options used to
specify the location of the “main” simulation and some settings for how
these data will be read in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">input</span><span class="p">]</span>
<span class="c1">## options related to reading in the results to be analyzed</span>

<span class="c1"># directory containing model results</span>
<span class="n">baseDirectory</span> <span class="o">=</span> <span class="o">/</span><span class="nb">dir</span><span class="o">/</span><span class="k">for</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">output</span>

<span class="c1"># Note: an absolute path can be supplied for any of these subdirectories.</span>
<span class="c1"># A relative path is assumed to be relative to baseDirectory.</span>
<span class="c1"># By default, results are assumed to be directly in baseDirectory,</span>
<span class="c1"># i.e. &lt;baseDirecory&gt;/./</span>

<span class="c1"># subdirectory containing restart files</span>
<span class="n">runSubdirectory</span> <span class="o">=</span> <span class="o">.</span>
<span class="c1"># subdirectory for ocean history files</span>
<span class="n">oceanHistorySubdirectory</span> <span class="o">=</span> <span class="o">.</span>
<span class="c1"># subdirectory for sea ice history files</span>
<span class="n">seaIceHistorySubdirectory</span> <span class="o">=</span> <span class="o">.</span>

<span class="c1"># names of namelist and streams files, either a path relative to baseDirectory</span>
<span class="c1"># or an absolute path.</span>
<span class="n">oceanNamelistFileName</span> <span class="o">=</span> <span class="n">mpaso_in</span>
<span class="n">oceanStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">ocean</span>
<span class="n">seaIceNamelistFileName</span> <span class="o">=</span> <span class="n">mpassi_in</span>
<span class="n">seaIceStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">seaice</span>

<span class="c1"># name of the ocean and sea-ice mesh (e.g. EC30to60E2r2, WC14to60E2r3,</span>
<span class="c1"># ECwISC30to60E2r1, SOwISC12to60E2r4, oQU240, etc.)</span>
<span class="n">mpasMeshName</span> <span class="o">=</span> <span class="n">mesh</span>

<span class="c1"># Large datasets can encounter a memory error.  Specification of a maximum</span>
<span class="c1"># chunk size `maxChunkSize` can be helpful to prevent the memory error.  The</span>
<span class="c1"># current maximum chunk size assumes approximately 64GB of ram and large files</span>
<span class="c1"># with a single time slice.</span>
<span class="n">maxChunkSize</span> <span class="o">=</span> <span class="mi">10000</span>


<span class="c1"># Whether missing input data should produce an error.  If not, the user gets</span>
<span class="c1"># a warning and the time bounds are adjusted to the beginning and end of the</span>
<span class="c1"># available data</span>
<span class="n">errorOnMissing</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<section id="input-directories">
<h2>Input Directories<a class="headerlink" href="#input-directories" title="Permalink to this heading">¶</a></h2>
<p>The input directories are specified through a base directory and optionally
separate subdirectories for the run (continaing namelist, streams and and one
or more restart files for each MPAS component) and for each component’s
simulation output (“history” files).  You will always need to set
<code class="docutils literal notranslate"><span class="pre">baseDirectory</span></code> in a custom config file.</p>
<p>By default, all files are assumed to be located in the base directory.
However, E3SM supports short-term archiving of component output to separate
directories.  If this feature was enabled for the E3SM run to be analyzed, the
configuration should be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">baseDirectory</span> <span class="o">=</span> <span class="o">/</span><span class="nb">dir</span><span class="o">/</span><span class="k">for</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">output</span>
<span class="n">runSubdirectory</span> <span class="o">=</span> <span class="n">run</span>
<span class="n">oceanHistorySubdirectory</span> <span class="o">=</span> <span class="n">archive</span><span class="o">/</span><span class="n">ocn</span><span class="o">/</span><span class="n">hist</span>
<span class="n">seaIceHistorySubdirectory</span> <span class="o">=</span> <span class="n">archive</span><span class="o">/</span><span class="n">ice</span><span class="o">/</span><span class="n">hist</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">/dir/for/model/output</span></code> is replaced with the directory containing
the <code class="docutils literal notranslate"><span class="pre">run</span></code> and <code class="docutils literal notranslate"><span class="pre">archive</span></code> directories.</p>
</section>
<section id="namelist-files">
<h2>Namelist Files<a class="headerlink" href="#namelist-files" title="Permalink to this heading">¶</a></h2>
<p>MPAS components are configured with a namelist file containing a very large
number of parameters and other configuration settings.  Part of the strength
of MPAS-Analysis is that it is aware of these namelists and can automatically
disable analysis tasks that are not supported under a given configuration.
By default, the namelist files for ocean and sea ice components are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanNamelistFileName</span> <span class="o">=</span> <span class="n">mpaso_in</span>
<span class="n">seaIceNamelistFileName</span> <span class="o">=</span> <span class="n">mpassi_in</span>
</pre></div>
</div>
<p>For older E3SM (v1 alpha and beta) runs, a different naming convention was used
and these options will need to be updated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanNamelistFileName</span> <span class="o">=</span> <span class="n">mpas</span><span class="o">-</span><span class="n">o_in</span>
<span class="n">seaIceNamelistFileName</span> <span class="o">=</span> <span class="n">mpas</span><span class="o">-</span><span class="n">cice_in</span>
</pre></div>
</div>
<p>The location of the namelist files is relative to the baseDirectory, so if
they are located within a run directory inside the base directory, they should
instead be specified as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanNamelistFileName</span> <span class="o">=</span> <span class="n">run</span><span class="o">/</span><span class="n">mpaso_in</span>
<span class="n">seaIceNamelistFileName</span> <span class="o">=</span> <span class="n">run</span><span class="o">/</span><span class="n">mpassi_in</span>
</pre></div>
</div>
</section>
<section id="streams-files">
<h2>Streams Files<a class="headerlink" href="#streams-files" title="Permalink to this heading">¶</a></h2>
<p>Streams files are used to configure input and output from MPAS components.
MPAS-Analysis can parse these files to determine the locations of output files
(using the <code class="docutils literal notranslate"><span class="pre">*HistorySubdirectory</span></code> to find them if they have been moved by
short-term archiving).  Similarly to namelist files, there are default names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">ocean</span>
<span class="n">seaIceStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">seaice</span>
</pre></div>
</div>
<p>alterations appropriate for E3SM v1 alpha and beta runs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">ocean</span>
<span class="n">seaIceStreamsFileName</span> <span class="o">=</span> <span class="n">streams</span><span class="o">.</span><span class="n">cice</span>
</pre></div>
</div>
<p>and the addition of the <code class="docutils literal notranslate"><span class="pre">run/</span></code> subdirectory if analyzing a run that used
short-term archiving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">oceanStreamsFileName</span> <span class="o">=</span> <span class="n">run</span><span class="o">/</span><span class="n">streams</span><span class="o">.</span><span class="n">ocean</span>
<span class="n">seaIceStreamsFileName</span> <span class="o">=</span> <span class="n">run</span><span class="o">/</span><span class="n">streams</span><span class="o">.</span><span class="n">seaice</span>
</pre></div>
</div>
</section>
<section id="mesh-name">
<h2>Mesh Name<a class="headerlink" href="#mesh-name" title="Permalink to this heading">¶</a></h2>
<p>The MPAS-Ocean and MPAS-Seaice run on the same mesh.  There are a number of
standard E3SM ocean/sea ice meshes at various resolutions.  The meshes
currently supported by the public release of MPAS-Analysis include:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oEC60to30v3</span></code>: An Eddy-Closure (EC) mesh with 30-km resolution at the
poles and equator and 60-km resolution at mid latitudes,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oRRS30to10v3</span></code>: A Rossby-Radius-Scaled (RRS) mesh with 10-km resolution
at the poles and 30-km resolution at the equator,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oRRS18to6</span></code>: An RRS mesh with 6-km resolution at the poles and 18-km
resolution at the equator.</p></li>
</ul>
</div></blockquote>
<p>Mapping files (see <a class="reference internal" href="diagnostics.html#config-mapping-files"><span class="std std-ref">Mapping Files</span></a> below) and region mask files
(see <a class="reference internal" href="regions.html#config-region-groups"><span class="std std-ref">Region Groups</span></a>) are provided from the
<a class="reference external" href="https://web.lcrc.anl.gov/public/e3sm/diagnostics/">E3SM public data repository</a> for these meshes.  For assistance with other
mesh resolutions, please contact the MPAS-Analysis developers.</p>
</section>
<section id="xarray-and-dask">
<h2>Xarray and Dask<a class="headerlink" href="#xarray-and-dask" title="Permalink to this heading">¶</a></h2>
<p>MPAS-Analysis makes extensive use of the <a class="reference external" href="https://xarray.pydata.org/en/stable/">xarray package</a>, which uses the
<a class="reference external" href="https://dask.pydata.org/en/latest/">dask package</a> internally to perform operations that are too large to fit
in memory.  While most tasks in MPAS-Analysis have moved away from opening
multi-file data sets using xarray in favor of concatinating these data sets
together using NCO tools, there are some legacy options that users can modify
if they experience errors related to dask:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">maxChunkSize</span> <span class="o">=</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>If an out of memory error occurs, it may first be worth reducing the number
of parallel tasks running (see <a class="reference internal" href="execute.html#config-execute"><span class="std std-ref">Execute</span></a>) but if the error is
clearly related to dask (which might be the case, for example, if the error
occrus in the <code class="docutils literal notranslate"><span class="pre">streamfunctionMOC</span></code> task), you may wish to reduce the
<code class="docutils literal notranslate"><span class="pre">maxChunkSize</span></code>.  This will make tasks using dask slower but will reduce their
memory usage.</p>
</section>
<section id="errors-on-missing-data">
<h2>Errors on Missing Data<a class="headerlink" href="#errors-on-missing-data" title="Permalink to this heading">¶</a></h2>
<p>if <code class="docutils literal notranslate"><span class="pre">errorOnMissing</span> <span class="pre">=</span> <span class="pre">False</span></code>, the time ranges (<code class="docutils literal notranslate"><span class="pre">startYear</span></code> and <code class="docutils literal notranslate"><span class="pre">endYear</span></code>)
in <code class="docutils literal notranslate"><span class="pre">climatology</span></code>, <code class="docutils literal notranslate"><span class="pre">timeSeries</span></code>, and <code class="docutils literal notranslate"><span class="pre">index</span></code> will be clipped to the range
of the available data.  If this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, an error will be
produced.  A value of <code class="docutils literal notranslate"><span class="pre">end</span></code> can be used for <code class="docutils literal notranslate"><span class="pre">endYear</span></code> to indicate that the
full range of the available data should be used.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="diagnostics.html" class="btn btn-neutral float-left" title="Diagnostics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="output.html" class="btn btn-neutral float-right" title="Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright This software is open source software available under the BSD-3license. Copyright (c) 2022 Triad National Security, LLC. All rights reserved. Copyright (c) 2018 Lawrence Livermore National Security, LLC. All rights reserved. Copyright (c) 2018 UT-Battelle, LLC. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>